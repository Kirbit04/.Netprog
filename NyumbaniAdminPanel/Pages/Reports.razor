@page "/reports"
@using System.Collections.Generic
@using System.Linq
@using Microsoft.AspNetCore.Components
@using Microsoft.AspNetCore.Components.Rendering

<div class="page-container">
    <h1>Reports</h1>
    
    <div class="report-types">
        @foreach (var report in reportTypes)
        {
            <div class="report-card" @onclick="() => GenerateReport(report.Id)">
                <h3>@report.Name</h3>
                <p>@report.Description</p>
            </div>
        }
    </div>
    
    @if (loading)
    {
        <div class="loading">
            <p>Generating report...</p>
        </div>
    }
    
    @if (currentReport != null)
    {
        <div class="report-container">
            <div class="report-header">
                <h2>@currentReport.Name Report</h2>
                <button class="close-btn" @onclick="CloseReport">Close</button>
            </div>
            
            <div class="report-content">
                @if (currentReport.Id == "income")
                {
                    <div class="report-summary">
                        <div class="summary-card">
                            <h4>Total Income</h4>
                            <div class="summary-value">KES 2,580,000</div>
                        </div>
                        <div class="summary-card">
                            <h4>Average Monthly</h4>
                            <div class="summary-value">KES 258,000</div>
                        </div>
                    </div>
                    
                    <h3>Income by Property</h3>
                    <table class="report-table">
                        <thead>
                            <tr>
                                <th>Property</th>
                                <th>Income</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Elegant Apartment in Westlands</td>
                                <td>KES 850,000</td>
                            </tr>
                            <tr>
                                <td>Beachfront Villa in Nyali</td>
                                <td>KES 750,000</td>
                            </tr>
                            <tr>
                                <td>Commercial Space in CBD</td>
                                <td>KES 960,000</td>
                            </tr>
                            <tr>
                                <td>Cozy Studio in Parklands</td>
                                <td>KES 135,000</td>
                            </tr>
                            <tr>
                                <td>Bedsitter in Roysambu</td>
                                <td>KES 54,000</td>
                            </tr>
                        </tbody>
                    </table>
                }
                else if (currentReport.Id == "occupancy")
                {
                    <div class="report-summary">
                        <div class="summary-card">
                            <h4>Occupancy Rate</h4>
                            <div class="summary-value">75%</div>
                        </div>
                        <div class="summary-card">
                            <h4>Vacant Units</h4>
                            <div class="summary-value">3</div>
                        </div>
                        <div class="summary-card">
                            <h4>Occupied Units</h4>
                            <div class="summary-value">9</div>
                        </div>
                    </div>
                    
                    <h3>Property Status</h3>
                    <table class="report-table">
                        <thead>
                            <tr>
                                <th>Property</th>
                                <th>Status</th>
                                <th>Tenant</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Elegant Apartment in Westlands</td>
                                <td>Occupied</td>
                                <td>Daniel Mutuku</td>
                            </tr>
                            <tr>
                                <td>Spacious Family Home in Karen</td>
                                <td>Occupied</td>
                                <td>Daniel Mutuku</td>
                            </tr>
                            <tr>
                                <td>Commercial Space in CBD</td>
                                <td>Occupied</td>
                                <td>Michael Kipchoge</td>
                            </tr>
                            <tr>
                                <td>Investment Land in Syokimau</td>
                                <td>Vacant</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td>Modern Apartment in Kilimani</td>
                                <td>Vacant</td>
                                <td>-</td>
                            </tr>
                        </tbody>
                    </table>
                }
                else if (currentReport.Id == "maintenance")
                {
                    <div class="report-summary">
                        <div class="summary-card">
                            <h4>Total Cost</h4>
                            <div class="summary-value">KES 65,000</div>
                        </div>
                        <div class="summary-card">
                            <h4>Completed</h4>
                            <div class="summary-value">6</div>
                        </div>
                        <div class="summary-card">
                            <h4>Pending</h4>
                            <div class="summary-value">4</div>
                        </div>
                    </div>
                    
                    <h3>Maintenance Requests</h3>
                    <table class="report-table">
                        <thead>
                            <tr>
                                <th>Property</th>
                                <th>Issue</th>
                                <th>Cost</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Elegant Apartment</td>
                                <td>Leaking Bathroom Tap</td>
                                <td>KES 12,000</td>
                                <td>Completed</td>
                            </tr>
                            <tr>
                                <td>Cozy Studio</td>
                                <td>Faulty Electrical Socket</td>
                                <td>KES 4,500</td>
                                <td>Completed</td>
                            </tr>
                            <tr>
                                <td>Bedsitter</td>
                                <td>Blocked Drainage</td>
                                <td>KES 3,500</td>
                                <td>Completed</td>
                            </tr>
                            <tr>
                                <td>Beachfront Villa</td>
                                <td>Pool Pump Not Working</td>
                                <td>KES 15,000</td>
                                <td>Completed</td>
                            </tr>
                            <tr>
                                <td>Commercial Space</td>
                                <td>AC Not Cooling</td>
                                <td>KES 22,500</td>
                                <td>Completed</td>
                            </tr>
                        </tbody>
                    </table>
                }
                else if (currentReport.Id == "tenant")
                {
                    <div class="report-summary">
                        <div class="summary-card">
                            <h4>Total Tenants</h4>
                            <div class="summary-value">4</div>
                        </div>
                        <div class="summary-card">
                            <h4>On-Time Payment Rate</h4>
                            <div class="summary-value">91.2%</div>
                        </div>
                    </div>
                    
                    <h3>Tenant Payment History - Daniel Mutuku</h3>
                    <table class="report-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Property</th>
                                <th>Amount</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Oct 4, 2023</td>
                                <td>Townhouse in South C</td>
                                <td>KES 120,000</td>
                                <td>On time</td>
                            </tr>
                            <tr>
                                <td>Oct 3, 2023</td>
                                <td>Elegant Apartment</td>
                                <td>KES 85,000</td>
                                <td>On time</td>
                            </tr>
                            <tr>
                                <td>Oct 1, 2023</td>
                                <td>Family Home</td>
                                <td>KES 180,000</td>
                                <td>On time</td>
                            </tr>
                        </tbody>
                    </table>
                }
                else if (currentReport.Id == "lease")
                {
                    <div class="report-summary">
                        <div class="summary-card">
                            <h4>Total Leases</h4>
                            <div class="summary-value">11</div>
                        </div>
                        <div class="summary-card">
                            <h4>Expiring Soon</h4>
                            <div class="summary-value">3</div>
                        </div>
                    </div>
                    
                    <h3>Upcoming Lease Expirations</h3>
                    <table class="report-table">
                        <thead>
                            <tr>
                                <th>Property</th>
                                <th>Tenant</th>
                                <th>Expiry Date</th>
                                <th>Days Left</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Beachfront Villa in Nyali</td>
                                <td>Grace Adhiambo</td>
                                <td>Oct 31, 2023</td>
                                <td>15</td>
                            </tr>
                            <tr>
                                <td>Elegant Apartment in Westlands</td>
                                <td>Daniel Mutuku</td>
                                <td>Nov 30, 2023</td>
                                <td>45</td>
                            </tr>
                            <tr>
                                <td>Commercial Space in CBD</td>
                                <td>Michael Kipchoge</td>
                                <td>Jan 31, 2024</td>
                                <td>107</td>
                            </tr>
                        </tbody>
                    </table>
                }
                else
                {
                    <p>Report data is being prepared...</p>
                }
            </div>
        </div>
    }
</div>

<style>
    .page-container {
        padding: 20px;
        font-family: 'Segoe UI', Arial, sans-serif;
    }
    
    h1 {
        margin-bottom: 20px;
    }
    
    .report-types {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }
    
    .report-card {
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        padding: 20px;
        cursor: pointer;
    }
    
    .report-card:hover {
        background-color: #f8f9fa;
    }
    
    .report-card h3 {
        margin-top: 0;
        margin-bottom: 10px;
    }
    
    .report-card p {
        margin: 0;
        color: #666;
    }
    
    .loading {
        text-align: center;
        padding: 20px;
        background-color: #f8f9fa;
        border-radius: 8px;
    }
    
    .report-container {
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        margin-top: 20px;
    }
    
    .report-header {
        padding: 15px 20px;
        border-bottom: 1px solid #eee;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .report-header h2 {
        margin: 0;
        font-size: 18px;
    }
    
    .close-btn {
        background-color: #f8f9fa;
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 5px 10px;
        cursor: pointer;
    }
    
    .report-content {
        padding: 20px;
    }
    
    .report-summary {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
    }
    
    .summary-card {
        background-color: #f8f9fa;
        padding: 15px;
        border-radius: 4px;
    }
    
    .summary-card h4 {
        margin: 0 0 5px 0;
        font-size: 14px;
        color: #666;
    }
    
    .summary-value {
        font-size: 20px;
        font-weight: bold;
    }
    
    .report-table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
    }
    
    .report-table th {
        text-align: left;
        padding: 10px;
        background-color: #f8f9fa;
        border-bottom: 1px solid #ddd;
    }
    
    .report-table td {
        padding: 10px;
        border-bottom: 1px solid #eee;
    }
    
    @@media (max-width: 768px) {
        .report-types {
            grid-template-columns: 1fr;
        }
        
        .report-summary {
            grid-template-columns: 1fr;
        }
    }
</style>

@code {
    private List<ReportType> reportTypes = new List<ReportType>();
    private ReportType? currentReport;
    private bool loading = false;
    
    protected override void OnInitialized()
    {
        reportTypes = new List<ReportType>
        {
            new ReportType 
            { 
                Id = "income", 
                Name = "Rental Income", 
                Description = "View income from rent payments over time" 
            },
            new ReportType 
            { 
                Id = "occupancy", 
                Name = "Property Occupancy", 
                Description = "Track occupancy rates across your properties" 
            },
            new ReportType 
            { 
                Id = "maintenance", 
                Name = "Maintenance Cost", 
                Description = "Analyze maintenance expenses and requests" 
            },
            new ReportType 
            { 
                Id = "tenant", 
                Name = "Tenant Payment History", 
                Description = "Review tenant payment records and history" 
            },
            new ReportType 
            { 
                Id = "lease", 
                Name = "Lease Expiry", 
                Description = "Monitor upcoming lease expirations" 
            }
        };
    }
    
    private async Task GenerateReport(string reportId)
    {
        loading = true;
        StateHasChanged();
        
        // Simulate API call delay
        await Task.Delay(1000);
        
        currentReport = reportTypes.FirstOrDefault(r => r.Id == reportId);
        loading = false;
    }
    
    private void CloseReport()
    {
        currentReport = null;
    }
    
    public class ReportType
    {
        public string Id { get; set; } = "";
        public string Name { get; set; } = "";
        public string Description { get; set; } = "";
    }
}